rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // DEVELOPMENT MODE: Keep rules open for development
    // TODO: Switch to production rules before deploying to production
    // Uncomment the line below for development, comment for production
    match /{document=**} {
      allow read, write: if true; // DEVELOPMENT ONLY
    }
    
    // PRODUCTION RULES (currently commented out)
    // Uncomment these rules and comment out the development rule above for production
    /*
    // Users can only access their own data
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Blog posts are public for reading, admin-only for writing
    match /blogs/{blogId} {
      allow read: if true;
      allow write: if request.auth != null && 
        get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // Branding kits - users can only access their assigned kits
    match /brandkits/{kitId} {
      allow read: if request.auth != null && (
        request.auth.email in resource.data.email ||
        resource.data.email == request.auth.email
      );
      allow write: if request.auth != null && 
        get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // Newsletter subscriptions
    match /newsletter/{docId} {
      allow create: if true; // Anyone can subscribe
      allow read, update, delete: if request.auth != null && 
        get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // Airtable form submissions
    match /airtable-forms/{formId} {
      allow create: if true; // Anyone can submit forms
      allow read, update, delete: if request.auth != null && 
        get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == 'admin';
    }
    
    // Notification preferences - users control their own
    match /notificationPreferences/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Coaching sessions - users can only access their own
    match /coachingSessions/{sessionId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }
    
    // Financing applications - users can only access their own
    match /financingApplications/{applicationId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }
    
    // Default: Deny all other access
    match /{document=**} {
      allow read, write: if false;
    }
    */
  }
} 